<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureFile | File Encryption Tool</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <!-- Use only local Dropzone CSS -->
    <link rel="stylesheet" href="css/dropzone.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <!-- Add favicon -->
    <link rel="icon" type="image/svg+xml" href="images/shield-icon.svg">
    <link rel="icon" type="image/png" href="images/shield-icon.png">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="me-2">
                    <path d="M12 2L4 6V12C4 15.31 7.58 20 12 22C16.42 20 20 15.31 20 12V6L12 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 11C13.1046 11 14 10.1046 14 9C14 7.89543 13.1046 7 12 7C10.8954 7 10 7.89543 10 9C10 10.1046 10.8954 11 12 11Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 11V15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span style="font-weight: 600;">Secure</span><span style="font-weight: 300;">File</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/Saidgarnit/File-Encryption-Tool" target="_blank">
                            <i class="bi bi-github"></i> GitHub
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-primary text-white">
                        <h2 class="mb-0"><i class="bi bi-shield-lock"></i> File Encryption Tool</h2>
                    </div>
                    <div class="card-body">
                        <ul class="nav nav-tabs flex-nowrap" id="encryptTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="encrypt-tab" data-bs-toggle="tab" data-bs-target="#encrypt" type="button" role="tab">
                                    <i class="bi bi-lock d-none d-sm-inline"></i> Encrypt
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="decrypt-tab" data-bs-toggle="tab" data-bs-target="#decrypt" type="button" role="tab">
                                    <i class="bi bi-unlock d-none d-sm-inline"></i> Decrypt
                                </button>
                            </li>
                        </ul>
                        <div class="tab-content p-3" id="encryptTabsContent">
                            <!-- Encrypt Tab -->
                            <div class="tab-pane fade show active" id="encrypt" role="tabpanel">
                                <h3 class="mb-3">Encrypt Files</h3>
                                <p class="text-muted">Secure your files with AES-256 encryption</p>
                                
                                <div id="encrypt-dropzone" class="dropzone mb-4">
                                    <div class="dz-message">
                                        <div class="icon">
                                            <i class="bi bi-cloud-arrow-up-fill"></i>
                                        </div>
                                        <h4>Drag files here or click to upload</h4>
                                        <p class="text-muted">Files will be encrypted before download</p>
                                    </div>
                                </div>
                                
                                <div id="encrypt-file-info" class="file-info d-none">
                                    <div class="alert alert-info">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-info-circle-fill me-3 fs-4"></i>
                                            <div>
                                                <p class="mb-0"><strong>File selected:</strong> <span id="encrypt-filename"></span></p>
                                                <p class="mb-0"><strong>Size:</strong> <span id="encrypt-filesize"></span></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row g-3 mb-3">
                                    <div class="col-md-6">
                                        <label for="encryptPassword" class="form-label">Password</label>
                                        <div class="input-group">
                                            <input type="password" id="encryptPassword" class="form-control" placeholder="Enter secure password">
                                            <button class="btn btn-outline-secondary" type="button" id="toggleEncryptPassword">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="encryptPasswordConfirm" class="form-label">Confirm Password</label>
                                        <div class="input-group">
                                            <input type="password" id="encryptPasswordConfirm" class="form-control" placeholder="Confirm password">
                                            <button class="btn btn-outline-secondary" type="button" id="toggleEncryptPasswordConfirm">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Password Strength</label>
                                    <div class="progress">
                                        <div id="passwordStrength" class="progress-bar" role="progressbar" style="width: 0%"></div>
                                    </div>
                                    <div id="passwordFeedback" class="form-text mt-1"></div>
                                </div>
                                
                                <button id="encryptButton" class="btn btn-primary btn-lg" disabled>
                                    <i class="bi bi-lock-fill"></i> Encrypt & Download
                                </button>
                                
                                <div id="encryptProgress" class="progress mt-3 d-none">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <!-- Decrypt Tab -->
                            <div class="tab-pane fade" id="decrypt" role="tabpanel">
                                <h3 class="mb-3">Decrypt Files</h3>
                                <p class="text-muted">Restore your encrypted files</p>
                                
                                <div id="decrypt-dropzone" class="dropzone mb-4">
                                    <div class="dz-message">
                                        <div class="icon">
                                            <i class="bi bi-cloud-arrow-up-fill"></i>
                                        </div>
                                        <h4>Drag encrypted files here</h4>
                                        <p class="text-muted">Select .encrypted files to decrypt</p>
                                    </div>
                                </div>
                                
                                <div id="decrypt-file-info" class="file-info d-none">
                                    <div class="alert alert-info">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-info-circle-fill me-3 fs-4"></i>
                                            <div>
                                                <p class="mb-0"><strong>File selected:</strong> <span id="decrypt-filename"></span></p>
                                                <p class="mb-0"><strong>Size:</strong> <span id="decrypt-filesize"></span></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="decryptPassword" class="form-label">Password</label>
                                    <div class="input-group">
                                        <input type="password" id="decryptPassword" class="form-control" placeholder="Enter password for decryption">
                                        <button class="btn btn-outline-secondary" type="button" id="toggleDecryptPassword">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <button id="decryptButton" class="btn btn-primary btn-lg" disabled>
                                    <i class="bi bi-unlock-fill"></i> Decrypt & Download
                                </button>
                                
                                <div id="decryptProgress" class="progress mt-3 d-none">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                </div>
                                
                                <div id="integrityResult" class="mt-3 d-none">
                                    <div class="alert">
                                        <i class="bi me-2"></i>
                                        <span id="integrityMessage"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card shadow-sm">
                    <div class="card-header bg-light">
                        <h4 class="mb-0">About This Tool</h4>
                    </div>
                    <div class="card-body">
                        <p>This file encryption tool provides secure file protection with industry-standard encryption:</p>
                        <ul>
                            <li><strong>AES-256 Encryption:</strong> Military-grade encryption algorithm</li>
                            <li><strong>Local Processing:</strong> All encryption happens in your browser, files never leave your device</li>
                            <li><strong>Integrity Verification:</strong> SHA-256 hash checks verify file integrity after decryption</li>
                        </ul>
                        <div class="alert alert-warning">
                            <div class="d-flex">
                                <i class="bi bi-exclamation-triangle-fill fs-4 me-3"></i>
                                <div>
                                    <strong>Important:</strong>
                                    <p class="mb-0">If you forget your encryption password, your files cannot be recovered. Always keep your passwords secure.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer py-3">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6 mb-3 mb-md-0">
                    <div class="d-flex align-items-center">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="me-2">
                            <path d="M12 2L4 6V12C4 15.31 7.58 20 12 22C16.42 20 20 15.31 20 12V6L12 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 11C13.1046 11 14 10.1046 14 9C14 7.89543 13.1046 7 12 7C10.8954 7 10 7.89543 10 9C10 10.1046 10.8954 11 12 11Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 11V15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <p class="mb-0"><span style="font-weight: 600;">Secure</span><span style="font-weight: 300;">File</span> Â© 2025</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <p class="mb-0 text-md-end">Developed by <a href="https://github.com/Saidgarnit" target="_blank">Saidgarnit</a> | <a href="https://github.com/Saidgarnit/File-Encryption-Tool" target="_blank">View on GitHub</a></p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Libraries - Ensure Dropzone is loaded BEFORE application scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/crypto-js.min.js"></script>
    <script src="lib/dropzone.min.js"></script>

    <!-- Disable Dropzone autoDiscover immediately after loading -->
    <script>
        if (typeof Dropzone !== 'undefined') {
            Dropzone.autoDiscover = false;
            console.log('Dropzone autoDiscover disabled');
        }
    </script>

    <!-- Simple error handling for script loading -->
    <script>
        window.addEventListener('error', function(e) {
            if (e.target && e.target.tagName && e.target.tagName.toLowerCase() === 'script') {
                console.error('Failed to load script:', e.target.src);
                if (e.target.src.includes('dropzone')) {
                    alert('Failed to load Dropzone library. File upload may not work properly.');
                }
            }
        }, true);
    </script>

    <!-- Application Scripts -->
    <script src="js/encryption.js"></script>
    <script src="js/fileHandling.js"></script>
    <script src="js/app.js"></script>
</body>
</html>